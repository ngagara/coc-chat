(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{43:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(36),i=a.n(n),r=(a(43),a(20)),l=a(38),o=a(2),u=c.a.createContext(),j=[{lang:"RU",options:[{title:"\u043e\u0431\u0449\u0438\u0439",to:"general",status:!0},{title:"\u043a\u043b\u0430\u043d",to:"clan",status:!1},{title:"\u0434\u0440\u0443\u0437\u044c\u044f",to:"friends",status:!1},{title:"\u043d\u043e\u0432\u043e\u0441\u0442\u0438",to:"news",status:!1}]},{lang:"EN",options:[{title:"general",to:"general",status:!1},{title:"clan",to:"clan",status:!1},{title:"friends",to:"friends",status:!1},{title:"news",to:"news",status:!1}]},{lang:"ZHO",options:[{title:"\u804a\u5929\u53cb\u4eec",to:"general",status:!1},{title:"\u6c0f\u65cf\u670b",to:"clan",status:!1},{title:"\u6d88\u606f",to:"friends",status:!1},{title:"\u670b\u53cb\u4eec",to:"news",status:!1}]}],h=(a(8),a.p+"static/media/arrow.f97395a0.svg"),d=a.p+"static/media/arrow_s.ffb78e82.svg",m=a.p+"static/media/enlarge.80864486.svg",b=a.p+"static/media/minimize.85ecfccb.svg",_=a(0);var g=function(e){var t=e.isActive,a=e.handSelectedLang,s=c.a.useContext(u).NAV;return Object(_.jsx)("div",{className:"chat__drop-container ".concat(t?"chat__drop-container_active":""),children:s&&s.map((function(e,t){return Object(_.jsx)("p",{className:"chat__drop-lang",onClick:function(){a(e.lang)},children:e.lang},t)}))})};var O=function(e){var t=e.goTo,a=e.lang,s=e.handleMinimize,n=e.handleEnlarge,i=e.handSelectedLang,r=e.handleShiftNav,l=e.handleActiveDropdown,o=e.isShift,j=e.isActive,O=c.a.useContext(u),f=O.enlarge,x=O.minimize,p=O.NAV;return Object(_.jsxs)("div",{className:"chat__header ".concat(f?"chat__header_b-size":""),children:[Object(_.jsx)("nav",{className:"chat__nav ".concat(f?"chat__nav_b-size":""),children:Object(_.jsx)("ul",{className:"chat__links ".concat(o?"chat__links_shift":"","  ").concat(f?"chat__links_b-size":""),children:Object.values(p).map((function(e){return e.lang===a&&e.options.map((function(e,a){return Object(_.jsx)("li",{onClick:function(){t(e)},className:"chat__link ".concat(e.status?"chat__link_active":""),children:e.title},a)}))}))})}),Object(_.jsx)("button",{className:"button chat__arrow-button",style:f?{display:"none"}:{display:"block"},onClick:r,children:Object(_.jsx)("img",{className:"chat__arrow-icon chat__arrow-icon_nav",src:h,alt:""})}),Object(_.jsxs)("div",{className:"chat__drop-wrapper",children:[Object(_.jsx)("p",{className:"chat__drop-lang chat__drop-lang_selected",children:a}),Object(_.jsx)("button",{className:"button chat__arrow-button ".concat(j?"chat__arrow-button_drop":""),onClick:l,disabled:x,children:Object(_.jsx)("img",{className:"chat__arrow-icon",src:d,alt:""})}),Object(_.jsx)(g,{isActive:j,handSelectedLang:i})]}),Object(_.jsxs)("div",{className:"chat__size-container",children:[Object(_.jsx)("button",{className:"button chat__minimize-button",onClick:s,children:Object(_.jsx)("img",{className:"chat__minimize-icon",src:b,alt:""})}),Object(_.jsx)("button",{className:"button chat__enlarge-button",children:Object(_.jsx)("img",{className:"chat__enlarge-icon",src:m,onClick:n,alt:""})})]})]})},f=a.p+"static/media/BTC.8f7ba890.svg",x=function(e){var t=e.name,a=e.userBadge,c=e.statusBadge,n=e.text,i=e.time,r=Object(s.useState)(0),l=Object(o.a)(r,2),u=l[0],j=l[1];return Object(s.useEffect)((function(){var e=1+9*Math.random();j(Math.floor(e))}),[]),Object(_.jsxs)("div",{className:"chat__message-container",children:[Object(_.jsxs)("div",{className:"chat__message",children:[Object(_.jsxs)("div",{className:"chat__message-header",children:[Object(_.jsx)("img",{className:"chat__user-badge",src:a,alt:"\u0417\u043d\u0430\u0447\u043e\u043a \u042e\u0437\u0435\u0440\u0430"}),Object(_.jsx)("p",{className:"chat__user-name",children:t}),Object(_.jsx)("p",{className:"chat__user-level",children:u}),c&&Object(_.jsx)("img",{className:"chat__status-badge",src:c,alt:"\u0421\u0442\u0430\u0442\u0443\u0441"})]}),Object(_.jsx)("p",{className:"chat__message-text",children:n})]}),Object(_.jsx)("p",{className:"chat__message-time",children:i})]})};var p=function(e){var t=e.text,a=e.time;return Object(_.jsxs)("div",{className:"chat__message-container chat__message-container_user",children:[Object(_.jsx)("div",{className:"chat__message chat__message_user",children:Object(_.jsx)("p",{className:"chat__message-text chat__message-text_user",children:t})}),Object(_.jsx)("p",{className:"chat__message-time",children:a})]})},v=function(e){var t=e.lang,a=e.scrollHandler,s=c.a.useContext(u),n=s.messages,i=s.userMessage,r=s.messagesEndRef;function l(e){return e.substr(11,5)}return Object(_.jsxs)("div",{className:"chat__container chat__container_general",onScroll:a,children:[Object(_.jsx)("div",{ref:r,className:"chat__fake-block"}),"RU"===t?Object(_.jsx)(_.Fragment,{children:n&&n.map((function(e){return e.from===i.from?Object(_.jsx)(p,{text:e.text,time:l(e.createdAt)},e.id):Object(_.jsx)(x,{name:e.from,userBadge:f,time:l(e.createdAt),text:e.text},e.id)}))}):Object(_.jsx)(_.Fragment,{children:n&&n.map((function(e){return e.from===i.from?Object(_.jsx)(p,{text:e.text,time:l(e.createdAt)},e.id):null}))})]})};var N=function(){return Object(_.jsx)("div",{className:"chat__container",children:Object(_.jsx)("h1",{children:"\u041a\u041b\u0410\u041d!"})})};var k=function(){return Object(_.jsx)("div",{className:"chat__container",children:Object(_.jsx)("h1",{children:"\u0414\u0440\u0443\u0437\u044c\u044f"})})};var w=function(){return Object(_.jsx)("div",{className:"chat__container",children:Object(_.jsx)("h1",{children:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"})})},S=a.p+"static/media/emodji.f5162e62.svg";var M=function(e){var t=e.sendMessage,a=e.setMessage,s=c.a.useContext(u).minimize;return Object(_.jsxs)("div",{className:"chat__footer",style:s?{display:"none"}:{display:"flex"},children:[Object(_.jsx)("input",{className:"chat__input",onChange:a,onKeyPress:t,type:"text",name:"text",minLength:"1",maxLength:"200",placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."}),Object(_.jsx)("button",{className:"button chat__emodji-button",children:Object(_.jsx)("img",{className:"chat__emodji-icon",src:S,alt:""})})]})};var z=function(e){var t=e.setMessage,a=e.sendMessage,s=e.scrollHandler,n=c.a.useContext(u),i=n.minimize,r=n.enlarge,l=n.link,o=n.lang;return Object(_.jsxs)("div",{className:"chat__main ".concat(r?"chat__main_b-size":""),style:i?{display:"none"}:{display:"flex"},children:["general"===l&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(v,{lang:o,scrollHandler:s}),Object(_.jsx)(M,{setMessage:t,sendMessage:a})]}),"clan"===l&&Object(_.jsx)(N,{}),"friends"===l&&Object(_.jsx)(k,{}),"news"===l&&Object(_.jsx)(w,{})]})},C=a(37),y=new function e(t){var a=this;Object(C.a)(this,e),this.getMessages=function(e){return fetch("".concat(a.baseUrl,"/messages?skip=",0,"&limit=").concat(e)).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status,". \u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d."))}))},this.baseUrl=t.baseUrl}({baseUrl:"https://api-23eqo.ondigitalocean.app/api"}),A=(0,a(45).io)("wss://api-23eqo.ondigitalocean.app",{transports:["websocket"],upgrade:!1}),E=c.a.memo((function(){var e=Object(s.useState)("general"),t=Object(o.a)(e,2),a=t[0],c=t[1],n=Object(s.useState)("RU"),i=Object(o.a)(n,2),h=i[0],d=i[1],m=Object(s.useState)([]),b=Object(o.a)(m,2),g=b[0],f=b[1],x=Object(s.useState)("username"),p=Object(o.a)(x,2),v=p[0],N=(p[1],Object(s.useState)(!1)),k=Object(o.a)(N,2),w=k[0],S=k[1],M=Object(s.useState)(!1),C=Object(o.a)(M,2),E=C[0],L=C[1],U=Object(s.useState)(!1),H=Object(o.a)(U,2),R=H[0],B=H[1],T=Object(s.useState)(!1),V=Object(o.a)(T,2),F=V[0],P=V[1],q=Object(s.useState)(15),D=Object(o.a)(q,2),I=D[0],J=D[1],K=Object(s.useState)({from:"".concat(v),text:""}),Z=Object(o.a)(K,2),G=Z[0],Q=Z[1],W=Object(s.useRef)(null);Object(s.useEffect)((function(){y.getMessages(I).then((function(e){f(e)})),console.log(I)}),[I]),Object(s.useEffect)((function(){A.addEventListener("message",(function(e){f((function(t){return[e].concat(Object(l.a)(t))}))}))}),[]);return Object(_.jsx)(u.Provider,{value:{messages:g,userMessage:G,userName:v,minimize:w,enlarge:E,NAV:j,link:a,lang:h,messagesEndRef:W},children:Object(_.jsxs)("aside",{className:"chat ".concat(E?"chat_b-size":""),children:[Object(_.jsx)(O,{goTo:function(e){c(e.to),function(e){!1===e.status&&(Object.values(j).map((function(e){return e.options.map((function(e){return e.status=!1}))})),e.status=!e.status)}(e)},lang:h,setLang:d,handleMinimize:function(){S(!w),L(!1),B(!1)},handleEnlarge:function(){L(!E),S(!1)},handSelectedLang:function(e){return d(e),B(!R),P(!1),Object.values(j).map((function(e){return e.options.map((function(e){return a===e.to?e.status=!0:e.status=!1}))}))},handleShiftNav:function(){P(!F)},handleActiveDropdown:function(){B(!R)},isShift:F,isActive:R}),Object(_.jsx)(z,{setMessage:function(e){Q((function(t){return Object(r.a)(Object(r.a)({},t),{},{text:e.target.value})}))},sendMessage:function(e){e.target.value<1||"Enter"===e.key&&(W.current.scrollIntoView({block:"end",behavior:"smooth"}),A.emit("message",G,(function(e){e?console.error(e):(y.getMessages(I).then((function(e){f(e)})),console.log("success"))})),e.target.value="")},scrollHandler:function(e){e.target.scrollHeight-Math.floor(Math.abs(e.target.scrollTop))<=322&&J((function(e){return e+15}))}})]})})}));a(77);var L=function(){return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(E,{})})};i.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(L,{})}),document.getElementById("root"))},8:function(e,t,a){}},[[78,1,2]]]);
//# sourceMappingURL=main.6feac281.chunk.js.map